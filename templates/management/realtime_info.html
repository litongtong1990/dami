{% extends "management/base.html" %}
{% block title %}生成二维码{% endblock %}

{% block content %}


<script type="text/javascript">
    $(document).ready(function(){
        setInterval("startrequest()",1000); 
        }); 
</script>



    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3 col-sm-10 col-sm-offset-1">
                

                {% if state == 'success' %}
                    <div class="well">
                        <h2 class="text-success text-center">生成二维码成功</h2>
                    </div>
                {% elif state == 'error' %}
                    <div class="well">
                        <h2 class="text-danger text-center">生成二维码失败</h2>
                    </div>
                {% endif %}
                

                <div class="row">
                    
                    <div class="col-sm-8">
                        <form method="POST" role="form" class="form-horizontal" enctype="multipart/form-data">
                            {% csrf_token %}
                            <h3 class="form-signin-heading text-center">实时数据测试</h3>

                            <div class="form-group">
                                <label for="id_name" class="col-md-3 control-label">温度</label>
                                <div id="temperature">温度测试</div>
                            </div>



                            <div class="form-group">
                                <label for="id_description" class="col-md-3 control-label">湿度</label>
                                <div id="humidity">湿度</div>
                            </div>

                            <div class="form-group">
                                <label for="id_description" class="col-md-3 control-label">光照</label>
                                <div id="lux">光照</div>
                            </div>

<!--                             
                            <a class="btn btn-large btn-success" id="fire" >Send Email</a>

 -->

                            <script type="text/javascript">



                                // $('#fire').on('click', function (e) {
                                //      // $.get('/json_test/', function(data){
                                //      //        alert(data);
                                //      //       });
                                //     $.getJSON('/json_test', function(data) {
                                //         $.each(data, function(index, element) {
                                //                 console.log(index+" : "+ element);   
                                //                 $("#"+index).text(element);                                                
                                //         });
                                //     });
                                // })


                                function startrequest() {
                                    $.getJSON('/json_test', function(data) {
                                        $.each(data, function(index, element) {
                                                console.log(index+" : "+ element);   
                                                $("#"+index).text(element);                                                
                                        });
                                    });
                                }

                            </script>



                        </form>
                    </div>
                    
                    
                    <div class="col-sm-4">
                        {% if state == 'success' %}
                            <h3 class="form-signin-heading text-center">二维码</h3>
                            <img src="/qrcode/{{name}}/" alt="Random Name">


                        {% endif %}

                    </div>
                
                </div>



            </div>
        </div>
    </div>


{% endblock %}